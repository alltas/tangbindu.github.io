function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,a=Array(e.length);t<e.length;t++)a[t]=e[t];return a}return Array.from(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){return window.setTimeout(e,1e3/30)}}(),window.cancelRequestAnimFrame=function(){return window.cancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||clearTimeout}();try{!function(){"use strict";var e=function(){this.init()};e.prototype={init:function(){var e=this||t;return e._codecs={},e._howls=[],e._muted=!1,e._volume=1,e._canPlayEvent="canplaythrough",e._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,e.masterGain=null,e.noAudio=!1,e.usingWebAudio=!0,e.autoSuspend=!0,e.ctx=null,e.mobileAutoEnable=!0,e._setup(),e},volume:function(e){var a=this||t;if(e=parseFloat(e),a.ctx||d(),"undefined"!=typeof e&&e>=0&&1>=e){if(a._volume=e,a._muted)return a;a.usingWebAudio&&(a.masterGain.gain.value=e);for(var o=0;o<a._howls.length;o++)if(!a._howls[o]._webAudio)for(var r=a._howls[o]._getSoundIds(),n=0;n<r.length;n++){var i=a._howls[o]._soundById(r[n]);i&&i._node&&(i._node.volume=i._volume*e)}return a}return a._volume},mute:function(e){var a=this||t;a.ctx||d(),a._muted=e,a.usingWebAudio&&(a.masterGain.gain.value=e?0:a._volume);for(var o=0;o<a._howls.length;o++)if(!a._howls[o]._webAudio)for(var r=a._howls[o]._getSoundIds(),n=0;n<r.length;n++){var i=a._howls[o]._soundById(r[n]);i&&i._node&&(i._node.muted=!!e||i._muted)}return a},unload:function(){for(var e=this||t,a=e._howls.length-1;a>=0;a--)e._howls[a].unload();return e.usingWebAudio&&"undefined"!=typeof e.ctx.close&&(e.ctx.close(),e.ctx=null,d()),e},codecs:function(e){return(this||t)._codecs[e]},_setup:function(){var e=this||t;return e.state=e.ctx?e.ctx.state||"running":"running",e._autoSuspend(),e.noAudio||e._setupCodecs(),e},_setupCodecs:function(){var e=this||t,a="undefined"!=typeof Audio?new Audio:null;if(!a||"function"!=typeof a.canPlayType)return e;var o=a.canPlayType("audio/mpeg;").replace(/^no$/,""),r=e._navigator&&e._navigator.userAgent.match(/OPR\/([0-6].)/g),n=r&&parseInt(r[0].split("/")[1],10)<33;return e._codecs={mp3:!(n||!o&&!a.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!o,opus:!!a.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!a.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!a.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!a.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),aac:!!a.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!a.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(a.canPlayType("audio/x-m4a;")||a.canPlayType("audio/m4a;")||a.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(a.canPlayType("audio/x-mp4;")||a.canPlayType("audio/mp4;")||a.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!a.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),webm:!!a.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),dolby:!!a.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,"")},e},_enableMobileAudio:function(){var e=this||t,a=/iPhone|iPad|iPod|Android|BlackBerry|BB10|Silk|Mobi/i.test(e._navigator&&e._navigator.userAgent),o=!!("ontouchend"in window||e._navigator&&e._navigator.maxTouchPoints>0||e._navigator&&e._navigator.msMaxTouchPoints>0);if(!e._mobileEnabled&&e.ctx&&(a||o)){e._mobileEnabled=!1,e._mobileUnloaded||44100===e.ctx.sampleRate||(e._mobileUnloaded=!0,e.unload()),e._scratchBuffer=e.ctx.createBuffer(1,1,22050);var r=function(){var t=e.ctx.createBufferSource();t.buffer=e._scratchBuffer,t.connect(e.ctx.destination),"undefined"==typeof t.start?t.noteOn(0):t.start(0),t.onended=function(){t.disconnect(0),e._mobileEnabled=!0,e.mobileAutoEnable=!1,document.removeEventListener("touchend",r,!0)}};return document.addEventListener("touchend",r,!0),e}},_autoSuspend:function(){var e=this;if(e.autoSuspend&&e.ctx&&"undefined"!=typeof e.ctx.suspend&&t.usingWebAudio){for(var a=0;a<e._howls.length;a++)if(e._howls[a]._webAudio)for(var o=0;o<e._howls[a]._sounds.length;o++)if(!e._howls[a]._sounds[o]._paused)return e;return e._suspendTimer&&clearTimeout(e._suspendTimer),e._suspendTimer=setTimeout(function(){e.autoSuspend&&(e._suspendTimer=null,e.state="suspending",e.ctx.suspend().then(function(){e.state="suspended",e._resumeAfterSuspend&&(delete e._resumeAfterSuspend,e._autoResume())}))},3e4),e}},_autoResume:function(){var e=this;return e.ctx&&"undefined"!=typeof e.ctx.resume&&t.usingWebAudio?("running"===e.state&&e._suspendTimer?(clearTimeout(e._suspendTimer),e._suspendTimer=null):"suspended"===e.state?(e.state="resuming",e.ctx.resume().then(function(){e.state="running"}),e._suspendTimer&&(clearTimeout(e._suspendTimer),e._suspendTimer=null)):"suspending"===e.state&&(e._resumeAfterSuspend=!0),e):void 0}};var t=new e,a=function(e){var t=this;return e.src&&0!==e.src.length?void t.init(e):void console.error("An array of source files must be passed with any new Howl.")};a.prototype={init:function(e){var a=this;return t.ctx||d(),a._autoplay=e.autoplay||!1,a._format="string"!=typeof e.format?e.format:[e.format],a._html5=e.html5||!1,a._muted=e.mute||!1,a._loop=e.loop||!1,a._pool=e.pool||5,a._preload="boolean"!=typeof e.preload||e.preload,a._rate=e.rate||1,a._sprite=e.sprite||{},a._src="string"!=typeof e.src?e.src:[e.src],a._volume=void 0!==e.volume?e.volume:1,a._duration=0,a._state="unloaded",a._sounds=[],a._endTimers={},a._queue=[],a._onend=e.onend?[{fn:e.onend}]:[],a._onfade=e.onfade?[{fn:e.onfade}]:[],a._onload=e.onload?[{fn:e.onload}]:[],a._onloaderror=e.onloaderror?[{fn:e.onloaderror}]:[],a._onpause=e.onpause?[{fn:e.onpause}]:[],a._onplay=e.onplay?[{fn:e.onplay}]:[],a._onstop=e.onstop?[{fn:e.onstop}]:[],a._onmute=e.onmute?[{fn:e.onmute}]:[],a._onvolume=e.onvolume?[{fn:e.onvolume}]:[],a._onrate=e.onrate?[{fn:e.onrate}]:[],a._onseek=e.onseek?[{fn:e.onseek}]:[],a._webAudio=t.usingWebAudio&&!a._html5,"undefined"!=typeof t.ctx&&t.ctx&&t.mobileAutoEnable&&t._enableMobileAudio(),t._howls.push(a),a._preload&&a.load(),a},load:function(){var e=this,a=null;if(t.noAudio)return void e._emit("loaderror",null,"No audio support.");"string"==typeof e._src&&(e._src=[e._src]);for(var r=0;r<e._src.length;r++){var i,s;if(e._format&&e._format[r])i=e._format[r];else{if(s=e._src[r],"string"!=typeof s){e._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}i=/^data:audio\/([^;,]+);/i.exec(s),i||(i=/\.([^.]+)$/.exec(s.split("?",1)[0])),i&&(i=i[1].toLowerCase())}if(t.codecs(i)){a=e._src[r];break}}return a?(e._src=a,e._state="loading","https:"===window.location.protocol&&"http:"===a.slice(0,5)&&(e._html5=!0,e._webAudio=!1),new o(e),e._webAudio&&n(e),e):void e._emit("loaderror",null,"No codec support for selected audio sources.")},play:function(e,a){var o=this,r=null;if("number"==typeof e)r=e,e=null;else{if("string"==typeof e&&"loaded"===o._state&&!o._sprite[e])return null;if("undefined"==typeof e){e="__default";for(var n=0,i=0;i<o._sounds.length;i++)o._sounds[i]._paused&&!o._sounds[i]._ended&&(n++,r=o._sounds[i]._id);1===n?e=null:r=null}}var s=r?o._soundById(r):o._inactiveSound();if(!s)return null;if(r&&!e&&(e=s._sprite||"__default"),"loaded"!==o._state&&!o._sprite[e])return o._queue.push({event:"play",action:function(){o.play(o._soundById(s._id)?s._id:void 0)}}),s._id;if(r&&!s._paused)return a||setTimeout(function(){o._emit("play",s._id)},0),s._id;o._webAudio&&t._autoResume();var u=s._seek>0?s._seek:o._sprite[e][0]/1e3,d=(o._sprite[e][0]+o._sprite[e][1])/1e3-u,m=1e3*d/Math.abs(s._rate);s._paused=!1,s._ended=!1,s._sprite=e,s._seek=u,s._start=o._sprite[e][0]/1e3,s._stop=(o._sprite[e][0]+o._sprite[e][1])/1e3,s._loop=!(!s._loop&&!o._sprite[e][2]);var l=s._node;if(o._webAudio){var p=function(){o._refreshBuffer(s);var e=s._muted||o._muted?0:s._volume;l.gain.setValueAtTime(e,t.ctx.currentTime),s._playStart=t.ctx.currentTime,"undefined"==typeof l.bufferSource.start?s._loop?l.bufferSource.noteGrainOn(0,u,86400):l.bufferSource.noteGrainOn(0,u,d):s._loop?l.bufferSource.start(0,u,86400):l.bufferSource.start(0,u,d),m!==1/0&&(o._endTimers[s._id]=setTimeout(o._ended.bind(o,s),m)),a||setTimeout(function(){o._emit("play",s._id)},0)};"loaded"===o._state?p():(o.once("load",p,s._id),o._clearTimer(s._id))}else{var h=function(){l.currentTime=u,l.muted=s._muted||o._muted||t._muted||l.muted,l.volume=s._volume*t.volume(),l.playbackRate=s._rate,setTimeout(function(){l.play(),m!==1/0&&(o._endTimers[s._id]=setTimeout(o._ended.bind(o,s),m)),a||o._emit("play",s._id)},0)},c="loaded"===o._state&&(window&&window.ejecta||!l.readyState&&t._navigator.isCocoonJS);if(4===l.readyState||c)h();else{var f=function(){h(),l.removeEventListener(t._canPlayEvent,f,!1)};l.addEventListener(t._canPlayEvent,f,!1),o._clearTimer(s._id)}}return s._id},pause:function(e){var t=this;if("loaded"!==t._state)return t._queue.push({event:"pause",action:function(){t.pause(e)}}),t;for(var a=t._getSoundIds(e),o=0;o<a.length;o++){t._clearTimer(a[o]);var r=t._soundById(a[o]);if(r&&!r._paused){if(r._seek=t.seek(a[o]),r._rateSeek=0,r._paused=!0,t._stopFade(a[o]),r._node)if(t._webAudio){if(!r._node.bufferSource)return t;"undefined"==typeof r._node.bufferSource.stop?r._node.bufferSource.noteOff(0):r._node.bufferSource.stop(0),t._cleanBuffer(r._node)}else isNaN(r._node.duration)&&r._node.duration!==1/0||r._node.pause();arguments[1]||t._emit("pause",r._id)}}return t},stop:function(e,t){var a=this;if("loaded"!==a._state)return a._queue.push({event:"stop",action:function(){a.stop(e)}}),a;for(var o=a._getSoundIds(e),r=0;r<o.length;r++){a._clearTimer(o[r]);var n=a._soundById(o[r]);if(n&&!n._paused&&(n._seek=n._start||0,n._rateSeek=0,n._paused=!0,n._ended=!0,a._stopFade(o[r]),n._node))if(a._webAudio){if(!n._node.bufferSource)return a;"undefined"==typeof n._node.bufferSource.stop?n._node.bufferSource.noteOff(0):n._node.bufferSource.stop(0),a._cleanBuffer(n._node)}else isNaN(n._node.duration)&&n._node.duration!==1/0||(n._node.currentTime=n._start||0,n._node.pause());n&&!t&&a._emit("stop",n._id)}return a},mute:function(e,a){var o=this;if("loaded"!==o._state)return o._queue.push({event:"mute",action:function(){o.mute(e,a)}}),o;if("undefined"==typeof a){if("boolean"!=typeof e)return o._muted;o._muted=e}for(var r=o._getSoundIds(a),n=0;n<r.length;n++){var i=o._soundById(r[n]);i&&(i._muted=e,o._webAudio&&i._node?i._node.gain.setValueAtTime(e?0:i._volume,t.ctx.currentTime):i._node&&(i._node.muted=!!t._muted||e),o._emit("mute",i._id))}return o},volume:function(){var e,a,o=this,r=arguments;if(0===r.length)return o._volume;if(1===r.length){var n=o._getSoundIds(),i=n.indexOf(r[0]);i>=0?a=parseInt(r[0],10):e=parseFloat(r[0])}else r.length>=2&&(e=parseFloat(r[0]),a=parseInt(r[1],10));var s;if(!("undefined"!=typeof e&&e>=0&&1>=e))return s=a?o._soundById(a):o._sounds[0],s?s._volume:0;if("loaded"!==o._state)return o._queue.push({event:"volume",action:function(){o.volume.apply(o,r)}}),o;"undefined"==typeof a&&(o._volume=e),a=o._getSoundIds(a);for(var u=0;u<a.length;u++)s=o._soundById(a[u]),s&&(s._volume=e,r[2]||o._stopFade(a[u]),o._webAudio&&s._node&&!s._muted?s._node.gain.setValueAtTime(e,t.ctx.currentTime):s._node&&!s._muted&&(s._node.volume=e*t.volume()),o._emit("volume",s._id));return o},fade:function(e,a,o,r){var n=this,i=Math.abs(e-a),s=e>a?"out":"in",u=i/.01,d=o/u;if("loaded"!==n._state)return n._queue.push({event:"fade",action:function(){n.fade(e,a,o,r)}}),n;n.volume(e,r);for(var m=n._getSoundIds(r),l=0;l<m.length;l++){var p=n._soundById(m[l]);if(p){if(r||n._stopFade(m[l]),n._webAudio&&!p._muted){var h=t.ctx.currentTime,c=h+o/1e3;p._volume=e,p._node.gain.setValueAtTime(e,h),p._node.gain.linearRampToValueAtTime(a,c)}var f=e;p._interval=setInterval(function(e,t){f+="in"===s?.01:-.01,f=Math.max(0,f),f=Math.min(1,f),f=Math.round(100*f)/100,n._webAudio?("undefined"==typeof r&&(n._volume=f),t._volume=f):n.volume(f,e,!0),f===a&&(clearInterval(t._interval),t._interval=null,n.volume(f,e),n._emit("fade",e))}.bind(n,m[l],p),d)}}return n},_stopFade:function(e){var a=this,o=a._soundById(e);return o&&o._interval&&(a._webAudio&&o._node.gain.cancelScheduledValues(t.ctx.currentTime),clearInterval(o._interval),o._interval=null,a._emit("fade",e)),a},loop:function(){var e,t,a,o=this,r=arguments;if(0===r.length)return o._loop;if(1===r.length){if("boolean"!=typeof r[0])return a=o._soundById(parseInt(r[0],10)),!!a&&a._loop;e=r[0],o._loop=e}else 2===r.length&&(e=r[0],t=parseInt(r[1],10));for(var n=o._getSoundIds(t),i=0;i<n.length;i++)a=o._soundById(n[i]),a&&(a._loop=e,o._webAudio&&a._node&&a._node.bufferSource&&(a._node.bufferSource.loop=e));return o},rate:function(){var e,a,o=this,r=arguments;if(0===r.length)a=o._sounds[0]._id;else if(1===r.length){var n=o._getSoundIds(),i=n.indexOf(r[0]);i>=0?a=parseInt(r[0],10):e=parseFloat(r[0])}else 2===r.length&&(e=parseFloat(r[0]),a=parseInt(r[1],10));var s;if("number"!=typeof e)return s=o._soundById(a),s?s._rate:o._rate;if("loaded"!==o._state)return o._queue.push({event:"rate",action:function(){o.rate.apply(o,r)}}),o;"undefined"==typeof a&&(o._rate=e),a=o._getSoundIds(a);for(var u=0;u<a.length;u++)if(s=o._soundById(a[u])){s._rateSeek=o.seek(a[u]),s._playStart=o._webAudio?t.ctx.currentTime:s._playStart,s._rate=e,o._webAudio&&s._node&&s._node.bufferSource?s._node.bufferSource.playbackRate.value=e:s._node&&(s._node.playbackRate=e);var d=o.seek(a[u]),m=(o._sprite[s._sprite][0]+o._sprite[s._sprite][1])/1e3-d,l=1e3*m/Math.abs(s._rate);!o._endTimers[a[u]]&&s._paused||(o._clearTimer(a[u]),o._endTimers[a[u]]=setTimeout(o._ended.bind(o,s),l)),o._emit("rate",s._id)}return o},seek:function(){var e,a,o=this,r=arguments;if(0===r.length)a=o._sounds[0]._id;else if(1===r.length){var n=o._getSoundIds(),i=n.indexOf(r[0]);i>=0?a=parseInt(r[0],10):(a=o._sounds[0]._id,e=parseFloat(r[0]))}else 2===r.length&&(e=parseFloat(r[0]),a=parseInt(r[1],10));if("undefined"==typeof a)return o;if("loaded"!==o._state)return o._queue.push({event:"seek",action:function(){o.seek.apply(o,r)}}),o;var s=o._soundById(a);if(s){if(!("number"==typeof e&&e>=0)){if(o._webAudio){var u=o.playing(a)?t.ctx.currentTime-s._playStart:0,d=s._rateSeek?s._rateSeek-s._seek:0;return s._seek+(d+u*Math.abs(s._rate))}return s._node.currentTime}var m=o.playing(a);m&&o.pause(a,!0),s._seek=e,s._ended=!1,o._clearTimer(a),m&&o.play(a,!0),!o._webAudio&&s._node&&(s._node.currentTime=e),o._emit("seek",a)}return o},playing:function(e){var t=this;if("number"==typeof e){var a=t._soundById(e);return!!a&&!a._paused}for(var o=0;o<t._sounds.length;o++)if(!t._sounds[o]._paused)return!0;return!1},duration:function(e){var t=this,a=t._duration,o=t._soundById(e);return o&&(a=t._sprite[o._sprite][1]/1e3),a},state:function(){return this._state},unload:function(){for(var e=this,a=e._sounds,o=0;o<a.length;o++){a[o]._paused||(e.stop(a[o]._id),e._emit("end",a[o]._id)),e._webAudio||(a[o]._node.src="data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQAAAAA=",a[o]._node.removeEventListener("error",a[o]._errorFn,!1),a[o]._node.removeEventListener(t._canPlayEvent,a[o]._loadFn,!1)),delete a[o]._node,e._clearTimer(a[o]._id);var n=t._howls.indexOf(e);n>=0&&t._howls.splice(n,1)}var i=!0;for(o=0;o<t._howls.length;o++)if(t._howls[o]._src===e._src){i=!1;break}return r&&i&&delete r[e._src],e._state="unloaded",e._sounds=[],e=null,null},on:function(e,t,a,o){var r=this,n=r["_on"+e];return"function"==typeof t&&n.push(o?{id:a,fn:t,once:o}:{id:a,fn:t}),r},off:function(e,t,a){var o=this,r=o["_on"+e],n=0;if(t){for(n=0;n<r.length;n++)if(t===r[n].fn&&a===r[n].id){r.splice(n,1);break}}else if(e)o["_on"+e]=[];else{var i=Object.keys(o);for(n=0;n<i.length;n++)0===i[n].indexOf("_on")&&Array.isArray(o[i[n]])&&(o[i[n]]=[])}return o},once:function(e,t,a){var o=this;return o.on(e,t,a,1),o},_emit:function(e,t,a){for(var o=this,r=o["_on"+e],n=r.length-1;n>=0;n--)r[n].id&&r[n].id!==t&&"load"!==e||(setTimeout(function(e){e.call(this,t,a)}.bind(o,r[n].fn),0),r[n].once&&o.off(e,r[n].fn,r[n].id));return o},_loadQueue:function(){var e=this;if(e._queue.length>0){var t=e._queue[0];e.once(t.event,function(){e._queue.shift(),e._loadQueue()}),t.action()}return e},_ended:function(e){var a=this,o=e._sprite,r=!(!e._loop&&!a._sprite[o][2]);if(a._emit("end",e._id),!a._webAudio&&r&&a.stop(e._id,!0).play(e._id),a._webAudio&&r){a._emit("play",e._id),e._seek=e._start||0,e._rateSeek=0,e._playStart=t.ctx.currentTime;var n=1e3*(e._stop-e._start)/Math.abs(e._rate);a._endTimers[e._id]=setTimeout(a._ended.bind(a,e),n)}return a._webAudio&&!r&&(e._paused=!0,e._ended=!0,e._seek=e._start||0,e._rateSeek=0,a._clearTimer(e._id),a._cleanBuffer(e._node),t._autoSuspend()),a._webAudio||r||a.stop(e._id),a},_clearTimer:function(e){var t=this;return t._endTimers[e]&&(clearTimeout(t._endTimers[e]),delete t._endTimers[e]),t},_soundById:function(e){for(var t=this,a=0;a<t._sounds.length;a++)if(e===t._sounds[a]._id)return t._sounds[a];return null},_inactiveSound:function(){var e=this;e._drain();for(var t=0;t<e._sounds.length;t++)if(e._sounds[t]._ended)return e._sounds[t].reset();return new o(e)},_drain:function(){var e=this,t=e._pool,a=0,o=0;if(!(e._sounds.length<t)){for(o=0;o<e._sounds.length;o++)e._sounds[o]._ended&&a++;for(o=e._sounds.length-1;o>=0;o--){if(t>=a)return;e._sounds[o]._ended&&(e._webAudio&&e._sounds[o]._node&&e._sounds[o]._node.disconnect(0),e._sounds.splice(o,1),a--)}}},_getSoundIds:function(e){var t=this;if("undefined"==typeof e){for(var a=[],o=0;o<t._sounds.length;o++)a.push(t._sounds[o]._id);return a}return[e]},_refreshBuffer:function(e){var a=this;return e._node.bufferSource=t.ctx.createBufferSource(),e._node.bufferSource.buffer=r[a._src],e._panner?e._node.bufferSource.connect(e._panner):e._node.bufferSource.connect(e._node),e._node.bufferSource.loop=e._loop,e._loop&&(e._node.bufferSource.loopStart=e._start||0,e._node.bufferSource.loopEnd=e._stop),e._node.bufferSource.playbackRate.value=e._rate,a},_cleanBuffer:function(e){var t=this;if(t._scratchBuffer){e.bufferSource.onended=null,e.bufferSource.disconnect(0);try{e.bufferSource.buffer=t._scratchBuffer}catch(e){}}return e.bufferSource=null,t}};var o=function(e){this._parent=e,this.init()};o.prototype={init:function(){var e=this,t=e._parent;return e._muted=t._muted,e._loop=t._loop,e._volume=t._volume,e._muted=t._muted,e._rate=t._rate,e._seek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=Math.round(Date.now()*Math.random()),t._sounds.push(e),e.create(),e},create:function(){var e=this,a=e._parent,o=t._muted||e._muted||e._parent._muted?0:e._volume;return a._webAudio?(e._node="undefined"==typeof t.ctx.createGain?t.ctx.createGainNode():t.ctx.createGain(),e._node.gain.setValueAtTime(o,t.ctx.currentTime),e._node.paused=!0,e._node.connect(t.masterGain)):(e._node=new Audio,e._errorFn=e._errorListener.bind(e),e._node.addEventListener("error",e._errorFn,!1),e._loadFn=e._loadListener.bind(e),e._node.addEventListener(t._canPlayEvent,e._loadFn,!1),e._node.src=a._src,e._node.preload="auto",e._node.volume=o*t.volume(),e._node.load()),e},reset:function(){var e=this,t=e._parent;return e._muted=t._muted,e._loop=t._loop,e._volume=t._volume,e._muted=t._muted,e._rate=t._rate,e._seek=0,e._rateSeek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=Math.round(Date.now()*Math.random()),e},_errorListener:function(){var e=this;e._node.error&&4===e._node.error.code&&(t.noAudio=!0),e._parent._emit("loaderror",e._id,e._node.error?e._node.error.code:0),e._node.removeEventListener("error",e._errorListener,!1)},_loadListener:function(){var e=this,a=e._parent;a._duration=Math.ceil(10*e._node.duration)/10,0===Object.keys(a._sprite).length&&(a._sprite={__default:[0,1e3*a._duration]}),"loaded"!==a._state&&(a._state="loaded",a._emit("load"),a._loadQueue()),a._autoplay&&a.play(),e._node.removeEventListener(t._canPlayEvent,e._loadFn,!1)}};var r={},n=function(e){var t=e._src;if(r[t])return e._duration=r[t].duration,void u(e);if(/^data:[^;]+;base64,/.test(t)){for(var a=atob(t.split(",")[1]),o=new Uint8Array(a.length),n=0;n<a.length;++n)o[n]=a.charCodeAt(n);s(o.buffer,e)}else{var d=new XMLHttpRequest;d.open("GET",t,!0),d.responseType="arraybuffer",d.onload=function(){var t=(d.status+"")[0];return"0"!==t&&"2"!==t&&"3"!==t?void e._emit("loaderror",null,"Failed loading audio file with status: "+d.status+"."):void s(d.response,e)},d.onerror=function(){e._webAudio&&(e._html5=!0,e._webAudio=!1,e._sounds=[],delete r[t],e.load())},i(d)}},i=function(e){try{e.send()}catch(t){e.onerror()}},s=function(e,a){t.ctx.decodeAudioData(e,function(e){e&&a._sounds.length>0&&(r[a._src]=e,u(a,e))},function(){a._emit("loaderror",null,"Decoding audio data failed.")})},u=function(e,t){t&&!e._duration&&(e._duration=t.duration),0===Object.keys(e._sprite).length&&(e._sprite={__default:[0,1e3*e._duration]}),"loaded"!==e._state&&(e._state="loaded",e._emit("load"),e._loadQueue()),e._autoplay&&e.play()},d=function(){t.noAudio=!1;try{"undefined"!=typeof AudioContext?t.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?t.ctx=new webkitAudioContext:t.usingWebAudio=!1}catch(e){t.usingWebAudio=!1}if(!t.usingWebAudio)if("undefined"!=typeof Audio)try{var e=new Audio;"undefined"==typeof e.oncanplaythrough&&(t._canPlayEvent="canplay")}catch(e){t.noAudio=!0}else t.noAudio=!0;try{var e=new Audio;e.muted&&(t.noAudio=!0)}catch(e){}var a=/iP(hone|od|ad)/.test(t._navigator&&t._navigator.platform),o=t._navigator&&t._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),r=o?parseInt(o[1],10):null;if(a&&r&&9>r){var n=/safari/.test(t._navigator&&t._navigator.userAgent.toLowerCase());(t._navigator&&t._navigator.standalone&&!n||t._navigator&&!t._navigator.standalone&&!n)&&(t.usingWebAudio=!1)}t.usingWebAudio&&(t.masterGain="undefined"==typeof t.ctx.createGain?t.ctx.createGainNode():t.ctx.createGain(),t.masterGain.gain.value=1,t.masterGain.connect(t.ctx.destination)),t._setup()};"function"==typeof define&&define.amd&&define([],function(){return{Howler:t,Howl:a}}),"undefined"!=typeof exports&&(exports.Howler=t,exports.Howl=a),"undefined"!=typeof window?(window.HowlerGlobal=e,window.Howler=t,window.Howl=a,window.Sound=o):"undefined"!=typeof global&&(global.HowlerGlobal=e,global.Howler=t,global.Howl=a,global.Sound=o)}()}catch(e){}var _createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,a,o){return a&&e(t.prototype,a),o&&e(t,o),t}}(),Charm=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?PIXI:arguments[0];if(_classCallCheck(this,e),void 0===t)throw new Error("Please assign a rendering engine in the constructor before using charm.js");this.renderer="",t.ParticleContainer&&t.Sprite&&(this.renderer="pixi"),this.globalTweens=[],this.easingFormulas={linear:function(e){return e},smoothstep:function(e){return e*e*(3-2*e)},smoothstepSquared:function(e){return Math.pow(e*e*(3-2*e),2)}}}return _createClass(e,[{key:"tweenProperty",value:function(e,t,a,o,r){var n=arguments.length<=5||void 0===arguments[5]?"smoothstep":arguments[5],i=this,s=arguments.length<=6||void 0===arguments[6]?!1:arguments[6],u=arguments.length<=7||void 0===arguments[7]?0:arguments[7],d={},m=n.split(" ");return"bounce"===m[0]&&(d.startMagnitude=parseInt(m[1]),d.endMagnitude=parseInt(m[2])),d.start=function(e,t){d.startValue=JSON.parse(JSON.stringify(e)),d.endValue=JSON.parse(JSON.stringify(t)),d.playing=!0,d.totalFrames=r,d.frameCounter=0,i.globalTweens.push(d)},d.start(a,o),d.update=function(){var a=void 0;if(d.playing)if(d.frameCounter<d.totalFrames){var o=d.frameCounter/d.totalFrames;a="bounce"!==m[0]?i.easingFormulas[n](o):i.easingFormulas.spline(o,d.startMagnitude,0,1,d.endMagnitude),e[t]=d.endValue*a+d.startValue*(1-a),d.frameCounter+=1}else e[t]=d.endValue,d.end()},d.end=function(){d.playing=!1,d.onComplete&&d.onComplete(),i.globalTweens.splice(i.globalTweens.indexOf(d),1),s&&i.wait(u).then(function(){d.start(d.endValue,d.startValue)})},d.play=function(){return d.playing=!0},d.pause=function(){return d.playing=!1},d}},{key:"makeTween",value:function(e){var t=this,a={};a.tweens=[],e.forEach(function(e){var o=t.tweenProperty.apply(t,_toConsumableArray(e));a.tweens.push(o)});var o=0;return a.completed=function(){o+=1,o===a.tweens.length&&(a.onComplete&&a.onComplete(),o=0)},a.tweens.forEach(function(e){e.onComplete=function(){return a.completed()}}),a.pause=function(){a.tweens.forEach(function(e){e.playing=!1})},a.play=function(){a.tweens.forEach(function(e){e.playing=!0})},a}},{key:"pulse",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?60:arguments[1],a=arguments.length<=2||void 0===arguments[2]?0:arguments[2];return this.tweenProperty(e,"alpha",e.alpha,a,t,"smoothstep",!0)}},{key:"slide",value:function(e,t,a){var o=arguments.length<=3||void 0===arguments[3]?60:arguments[3],r=arguments.length<=4||void 0===arguments[4]?"smoothstep":arguments[4],n=arguments.length<=5||void 0===arguments[5]?!1:arguments[5],i=arguments.length<=6||void 0===arguments[6]?0:arguments[6];return this.makeTween([[e,"x",e.x,t,o,r,n,i],[e,"y",e.y,a,o,r,n,i]])}},{key:"update",value:function(){if(this.globalTweens.length>0)for(var e=this.globalTweens.length-1;e>=0;e--){var t=this.globalTweens[e];t&&t.update()}}}]),e}(),gameresources=[{name:"gameroad",url:"../img/gameroad.png"},{name:"gameparallaxbg",url:"../img/gameparallaxbg.png"},{name:"brain",url:"../img/brain.png"},{name:"stuff",url:"../img/stuff.json"},{name:"roadstuff",url:"../img/roadstuff.json"},{name:"roadfacestuff",url:"../img/roadfacestuff.json"}],Game={debug:!0,director:null,map:null,hero:null,menu:null,totaldistance:0,rundistance:0,modeldistance:[],initstuffnum:8,verticalatio:.294,gifts:[],scale:1,winW:$(window).width(),winH:$(window).height(),speed:3.7,dynamicSpeed:3.7,heroSpeed:.75,lowphoneheroSpeed:.75,jumpSpeed:.95,model:0,mapLevel:0,jump1:!1,jump2:!1,timmer:null,progress:0,prize:[],capsules:[],roadsideobj:[],lastFameTime:0,fps:0,isios:!!navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),islowphone:!1,mapmodel:{level0:[{t:"gift",x:400,y:150},{t:1,x:330},{t:1,x:230},{t:1,x:300},{t:1,x:0,y:35},{t:1,x:30},{t:1,x:200},{t:1,x:200},{t:1,x:0,y:30},{t:1,x:260}],level1:[{t:1,x:400},{t:1,x:30},{t:1,x:0,y:30},{t:"gift",x:100,y:50},{t:1,x:180},{t:1,x:30},{t:1,x:160},{t:1,x:0,y:35},{t:"star",x:100,y:30},{t:1,x:230},{t:1,x:180},{t:1,x:30}],level2:[{t:1,x:430},{t:1,x:450},{t:1,x:30},{t:1,x:0,y:30},{t:1,x:180},{t:1,x:180},{t:"star",x:150,y:30},{t:1,x:220},{t:1,x:210},{t:1,x:30},{t:1,x:30},{t:1,x:180},{t:1,x:200},{t:1,x:0,y:30}],level3:[{t:1,x:500},{t:1,x:30},{t:1,x:0,y:30},{t:1,x:220},{t:1,x:0,y:35},{t:"star",x:300,y:30},{t:1,x:230},{t:1,x:180},{t:1,x:30},{t:1,x:30},{t:1,x:200},{t:1,x:30},{t:"star",x:100,y:30},{t:1,x:200},{t:1,x:30},{t:"gift",x:60}],level4:[{t:1,x:550},{t:1,x:30},{t:1,x:0,y:30},{t:1,x:200},{t:"gift",x:80,y:50},{t:1,x:180},{t:1,x:0,y:35},{t:1,x:30},{t:1,x:200},{t:1,x:30},{t:1,x:200},{t:1,x:30,y:0},{t:1,x:0,y:30},{t:1,x:30},{t:1,x:230},{t:1,x:180},{t:1,x:0,y:30},{t:1,x:230},{t:1,x:0,y:30},{t:1,x:300}],level5:[{t:1,x:600},{t:1,x:30},{t:1,x:0,y:35},{t:1,x:30},{t:1,x:300},{t:1,x:30},{t:1,x:30},{t:1,x:280},{t:1,x:230},{t:1,x:0,y:35},{t:"gift",x:60,y:50},{t:1,x:200},{t:1,x:30},{t:1,x:30},{t:1,x:300},{t:1,x:30},{t:1,x:30},{t:1,x:300},{t:1,x:30},{t:"door",x:500,y:-20}]},upgradeGame:function(){var e=0;e=Game.rundistance<Game.modeldistance[0]?0:Game.rundistance<Game.modeldistance[1]?1:Game.rundistance<Game.modeldistance[2]?2:Game.rundistance<Game.modeldistance[3]?3:Game.rundistance<Game.modeldistance[4]?4:5,Game.fps>2?(Game.islowphone||(Game.hero._sprite.state.timeScale=2/Game.fps*Game.heroSpeed),Game.islowphone&&(Game.lowphoneheroSpeed=2*Game.heroSpeed)):(Game.islowphone||Game.hero._sprite.state.timeScale==Game.herosprite||(Game.hero._sprite.state.timeScale=Game.heroSpeed),Game.islowphone&&(Game.lowphoneheroSpeed=Game.heroSpeed*Game.fps)),Game.model!=e&&(Game.model=e,0==this.model?(this.speed=3.7,this.heroSpeed=.75,Game.islowphone||(Game.hero._sprite.state.timeScale=Game.heroSpeed)):1==this.model?(this.speed=4,this.heroSpeed=.9,Game.islowphone||(Game.hero._sprite.state.timeScale=Game.heroSpeed)):2==this.model?(this.speed=4.3,this.heroSpeed=1,Game.islowphone||(Game.hero._sprite.state.timeScale=Game.heroSpeed)):3==this.model?(this.speed=5,this.heroSpeed=1.1,Game.islowphone||(Game.hero._sprite.state.timeScale=Game.heroSpeed)):4==this.model?(this.speed=5.5,this.heroSpeed=1.2,Game.islowphone||(Game.hero._sprite.state.timeScale=Game.heroSpeed)):(this.speed=6,this.heroSpeed=1.3,Game.islowphone||(Game.hero._sprite.state.timeScale=Game.heroSpeed)))},loadTexture:function(e){this.gamerole=window.gameroletype||"girl",Game.islowphone?gameresources.push({name:"heroframe",url:"../img/heroframe.json"}):("boy"==this.gamerole?gameresources.push({name:"herobone",url:"../bone/bone_boy/Boy_NeuropathyBoy_Suoyou.json"}):void 0,"girl"==this.gamerole?gameresources.push({name:"herobone",url:"../bone/bone_girl/Girl_NeuropathyGirl_Suoyou.json"}):void 0),this.loader=PIXI.loader.add(gameresources),this.loader.load(e)},init:function(){this.director=new GameDirector,"canvas"==window.rendertype&&(Game.islowphone=!0),this.herodirector=new GameHeroDirector,this.map=new GameMapObj,this.menu=new GameMenuObj,this.hero=new GameHeroObj,this.map.onEnter(),this.menu.onEnter(),this.herodirector._stage.addChild(this.hero._sprite),this.du=new Dust(PIXI),this.cr=new Charm(PIXI);try{this.music={bgmusic:new Howl({src:["../music/bgmusic.mp3"],loop:!0,volume:.6}),gameover:new Howl({src:["../music/gameover.mp3"],loop:!1,volume:2}),gift:new Howl({src:["../music/gift.mp3"],loop:!1}),jump2:new Howl({src:["../music/jump2.mp3"],loop:!1,volume:2}),success:new Howl({src:["../music/success.mp3"],loop:!1})},Game.music.jump2.on("end",function(){Game.music.bgmusic.pause(),Game.music.bgmusic.play()})}catch(e){}this.giftEffectContainer=new PIXI.particles.ParticleContainer(1500,{alpha:!0,scale:!0,rotation:!0,uvs:!0}),this.particleTexture="star",this.particleStream=this.du.emitter(17,function(){return Game.du.create(0,0,function(){return new PIXI.Sprite(PIXI.loader.resources.roadfacestuff.textures[Game.particleTexture+".png"])},Game.giftEffectContainer,25,.01,!0,0,6.28,2,40,5,10,.01,.02)}),Game.director._stage.addChild(Game.giftEffectContainer),this.director.renderStage()},gamestart:function(){Game.trigger("gamestart"),this.lastFameTime=performance.now(),this.refresh();try{Game.music.bgmusic.pause(),Game.music.bgmusic.play()}catch(e){}},gameover:function(){setTimeout(function(){cancelRequestAnimFrame(Game.timmer)},0),Game.trigger("gameover");try{Game.music.bgmusic.pause(),Game.music.gameover.play()}catch(e){}},reset:function(){this.model=0,this.mapLevel=0,this.rundistance=0,this.status=0,this.prize=[],this.menu.reset(),this.map.reset(),this.hero.reset(),Game.speed=3.7,Game.islowphone||(Game.hero._sprite.state.timeScale=.75),Game.director.renderStage()},refresh:function(){Game.rundistance+=Game.dynamicSpeed,Game.map.update(),Game.menu.update(),Game.hero.update(),Game.du.update(),Game.cr.update(),Game.collisionCheck(),Game.upgradeGame(),Game.director.renderStage(),Game.herodirector.renderStage(),Game.timmer=requestAnimFrame(Game.refresh);var e=performance.now();Game.fps=(e-Game.lastFameTime)/16.7,Game.fps=Game.fps<1?1:Game.fps,Game.fps=Game.fps.toFixed(1);var t=Game.fps>2?2:Game.fps;Game.dynamicSpeed=Game.speed*t,Game.lastFameTime=e},collisionCheck:function(){var e=Game.hero.getRect(),t=Game.collisionCapsule(e);t&&(Game.hero._sprite.tint=0,Game.director.renderStage(),Game.gameover());var a=Game.collisionGift(e);if(a){"gift"==a.getType()&&Game.prize.push(a),"door"!=a.getType()&&a.setAlpha(0),a.setState(0),Game.map.putObjToMap(),a.collisionEffect(a.getType());
try{Game.music.gift.play()}catch(o){}}},collisionCapsule:function(e){for(var t=0;t<Game.capsules.length;t++){var a=Game.capsules[t];if(1===a.getState()&&Game.collisionWithRect(e,a.getRect()))return a}return!1},collisionGift:function(e){for(var t=0;t<Game.gifts.length;t++){var a=Game.gifts[t];if(1===a.getState()&&Game.collisionWithRect(e,a.getRect()))return a}return!1},collisionWithRect:function(e,t){return!(e.y+e.h-1<t.y||e.y>t.y+t.h-1||e.x+e.w-1<t.x||e.x>t.x+t.w-1)},handler:function(e,t){"undefined"==typeof this.handlers&&(this.handlers={}),"undefined"==typeof this.handlers[e]&&(this.handlers[e]=new Array),this.handlers[e]=this.handlers[e].concat(t)},trigger:function(e){if("undefined"==typeof this.handlers&&(this.handlers={}),this.handlers[e]instanceof Array)for(var t=this.handlers[e],a=0,o=t.length;o>a;a++)t[a].call(this,this)}},GameDirector=function(){this._stage=new PIXI.Stage,this._stage.interactive=!0,this._renderer=PIXI.autoDetectRenderer(Game.winW,Game.winH,{transparent:!0,resolution:window.devicePixelRatio}),$(".page-game").append(this._renderer.view)};GameDirector.prototype={addSprite:function(e){e&&this._stage.addChild(e)},renderStage:function(){this._renderer.render(this._stage)}};var GameHeroDirector=function(){this._stage=new PIXI.Stage,this._stage.interactive=!0,this._renderer=PIXI.autoDetectRenderer(Game.winW,Game.winH,{transparent:!0,resolution:window.devicePixelRatio}),$(".page-game").append(this._renderer.view)};GameHeroDirector.prototype={addSprite:function(e){e&&this._stage.addChild(e)},renderStage:function(){this._renderer.render(this._stage)}};var GameSpriteObj=function(){};GameSpriteObj.prototype={_sprite:null,_texture:null,_status:0,_type:0,init:function(e,t,a){this._texture=a,this._sprite=new PIXI.Sprite(this._texture),this.setSize({w:e,h:t})},setState:function(e){this._state=e},getState:function(){return this._state},setType:function(e){this._type=e},getType:function(){return this._type},setSize:function(e){this._sprite.width=e.w,this._sprite.height=e.h},getSize:function(){return{w:this._sprite.width,h:this._sprite.height}},setPos:function(e){this._sprite.x=e.x,this._sprite.y=e.y},getPos:function(){return{x:this._sprite.x,y:this._sprite.y}},setAlpha:function(e){this._sprite.alpha=e},getAlpha:function(){return this._sprite.alpha},getRect:function(){return{x:this._sprite.x+.2*this._sprite.width,y:this._sprite.y+.2*this._sprite.width,w:.6*this._sprite.width,h:.6*this._sprite.height}},onEnter:function(){Game.director.addSprite(this._sprite)},onDestroy:function(){}};var GameMapObj=function(){this.init(),this.coutRSOloc=0,this.coutStuffloc=0,this.TotalStuffNum=0,this.currentStuffNum=0};GameMapObj.prototype={init:function(){this.gameparallaxbg1=new PIXI.Sprite(PIXI.loader.resources.gameparallaxbg.texture),this.gameparallaxbg2=new PIXI.Sprite(PIXI.loader.resources.gameparallaxbg.texture),this.gameroad1=new PIXI.Sprite(PIXI.loader.resources.gameroad.texture),this.gameroad2=new PIXI.Sprite(PIXI.loader.resources.gameroad.texture),this.gameforeground=new PIXI.Sprite(PIXI.loader.resources.roadstuff.textures["gameforeground.png"]),this.gameforeground1=new PIXI.Sprite(PIXI.loader.resources.roadstuff.textures["gameforeground1.png"]),this.gameforeground2=new PIXI.Sprite(PIXI.loader.resources.roadstuff.textures["gameforeground2.png"]),this.gameforeground3=new PIXI.Sprite(PIXI.loader.resources.roadstuff.textures["gameforeground3.png"]),this.gameforeground4=new PIXI.Sprite(PIXI.loader.resources.roadstuff.textures["gameforeground4.png"]),Game.scale=Game.winH*Game.verticalatio/(this.gameroad1.height/2)},onEnter:function(){this.initGameBg(),this.initRoadsideObj(),this.initGameRoad(),this.initMapModel(),this.initGameFore(),this.initCapsules(),this.initGift(),this.initBrain(),this.layoutCapsulesAndGiftToMap()},reset:function(){this.resetRoadsideObj(),this.updateGameRoad(0),this.coutStuffloc=0,this.currentStuffNum=0,this.layoutCapsulesAndGiftToMap()},update:function(){this.updateRoadsideObj(),this.updateGameRoad(Game.rundistance),this.updateCapsules(),this.updateGift(),this.updateBrain(),this.updateFore(),this.recycleRoadsideObj(),this.recycleCapsule(),this.recycleGift(),this.recycleMonster()},initCapsules:function(){for(var e=0;12>e;e++)cp=new GameCapsuleObj,Game.capsules.push(cp),cp.onEnter()},initGift:function(){for(var e=0;5>e;e++)cp=new GameGiftObj,Game.gifts.push(cp),cp.onEnter()},initBrain:function(){this.brain=new BrainObj,this.brain._sprite.anchor.x=.5,this.brain._sprite.anchor.y=.5,this.brain.onEnter()},layoutCapsulesAndGiftToMap:function(){for(var e in Game.capsules)Game.capsules[e].setState(0),Game.capsules[e].setAlpha(0);for(var e in Game.gifts)Game.gifts[e].setState(0),Game.gifts[e].setAlpha(0);for(var e=0;e<Game.initstuffnum;e++)Game.map.putObjToMap()},initRoadsideObj:function(){for(var e=0;6>e;e++)rso=new RoadsideObj,Game.roadsideobj.push(rso),rso.onEnter(),rso.putInRoadSide()},resetRoadsideObj:function(){Game.map.coutRSOloc=0;for(var e=0;e<Game.roadsideobj.length;e++)Game.roadsideobj[e].status=1,Game.roadsideobj[e].putInRoadSide()},updateRoadsideObj:function(){for(var e=0;e<Game.roadsideobj.length;e++){var t=Game.roadsideobj[e];1===t.getState()&&this.moveSprite(t)}},initGameBg:function(){this.gameparallaxbg1.scale.x=this.gameparallaxbg1.scale.y=this.gameparallaxbg2.scale.x=this.gameparallaxbg2.scale.y=.5*Game.scale,this.gameparallaxbg1.position.y=this.gameparallaxbg2.position.y=Game.winH-this.gameparallaxbg1.height,Game.director.addSprite(this.gameparallaxbg1),Game.director.addSprite(this.gameparallaxbg2)},initGameRoad:function(){this.gameroad1.scale.x=this.gameroad1.scale.y=this.gameroad2.scale.x=this.gameroad2.scale.y=.5*Game.scale,this.gameroad1.position.y=this.gameroad2.position.y=Game.winH-this.gameroad1.height,Game.director.addSprite(this.gameroad1),Game.director.addSprite(this.gameroad2)},initGameFore:function(){this.gameforeground2.width=this.gameforeground2.width/2*Game.scale,this.gameforeground2.height=this.gameforeground2.height/2*Game.scale,this.gameforeground2.position.x=Game.winW-2.5*this.gameforeground2.width,this.gameforeground2.position.y=Game.winH-this.gameforeground2.height,Game.director.addSprite(this.gameforeground2);var e=this.gameforeground.height/this.gameforeground.width;this.gameforeground.width=Game.winW,this.gameforeground.height=Game.winW*e,this.gameforeground.position.y=Game.winH-.9*this.gameforeground.height,Game.director.addSprite(this.gameforeground),this.gameforeground4.width=this.gameforeground4.width/2*Game.scale,this.gameforeground4.height=this.gameforeground4.height/2*Game.scale,this.gameforeground4.position.x=.6*this.gameforeground4.width,this.gameforeground4.position.y=Game.winH-1.3*this.gameforeground4.height,Game.director.addSprite(this.gameforeground4),this.gameforeground1.width=this.gameforeground1.width/2*Game.scale,this.gameforeground1.height=this.gameforeground1.height/2*Game.scale,this.gameforeground1.position.y=Game.winH-this.gameforeground1.height,Game.director.addSprite(this.gameforeground1),this.gameforeground3.width=this.gameforeground3.width/2*Game.scale,this.gameforeground3.height=this.gameforeground3.height/2*Game.scale,this.gameforeground3.position.x=Game.winW-this.gameforeground3.width,this.gameforeground3.position.y=Game.winH-.7*this.gameforeground3.height,Game.director.addSprite(this.gameforeground3),this.movepath=[-1,-1,-1,-1,-1,1,1,1,1,1,1,1,1,1,1,-1,-1,-1,-1,-1]},initMapModel:function(){var e=0;for(var t in Game.mapmodel){for(var a in Game.mapmodel[t])Game.mapmodel[t][a].x=(Game.mapmodel[t][a].x*Game.scale).toFixed(0),Game.mapmodel[t][a].y=Game.mapmodel[t][a].y?(Game.mapmodel[t][a].y*Game.scale).toFixed(0):null,Game.totaldistance+=Number(Game.mapmodel[t][a].x);Game.modeldistance[e]=Game.totaldistance,e++}},updateGameRoad:function(e){this.gameroad1.position.x=-e,this.gameroad1.position.x%=2*this.gameroad1.width,this.gameroad1.position.x<0&&(this.gameroad1.position.x+=2*this.gameroad1.width),this.gameroad1.position.x-=this.gameroad1.width,this.gameroad2.position.x=-e+this.gameroad1.width,this.gameroad2.position.x%=2*this.gameroad1.width,this.gameroad2.position.x<0&&(this.gameroad2.position.x+=2*this.gameroad1.width),this.gameroad2.position.x-=this.gameroad1.width,this.gameparallaxbg1.position.x=-(.2*e),this.gameparallaxbg1.position.x%=2*this.gameparallaxbg1.width,this.gameparallaxbg1.position.x<0&&(this.gameparallaxbg1.position.x+=2*this.gameparallaxbg1.width),this.gameparallaxbg1.position.x-=this.gameparallaxbg1.width,this.gameparallaxbg2.position.x=-(.2*e)+this.gameparallaxbg1.width,this.gameparallaxbg2.position.x%=2*this.gameparallaxbg1.width,this.gameparallaxbg2.position.x<0&&(this.gameparallaxbg2.position.x+=2*this.gameparallaxbg1.width),this.gameparallaxbg2.position.x-=this.gameparallaxbg1.width},moveSprite:function(e){e.setPos({x:e.getPos().x-Game.dynamicSpeed,y:e.getPos().y})},updateCapsules:function(){for(var e=0;e<Game.capsules.length;e++){var t=Game.capsules[e];1===t.getState()&&this.moveSprite(t)}},updateGift:function(){for(var e=0;e<Game.gifts.length;e++){var t=Game.gifts[e];1===t.getState()&&this.moveSprite(t)}},updateFore:function(){var e=(.05*Game.rundistance).toFixed(0)%this.movepath.length;this.gameforeground.y+=.02*this.movepath[e],this.gameforeground1.y+=.05*this.movepath[e],this.gameforeground2.y+=.2*this.movepath[e],this.gameforeground3.y+=.1*this.movepath[e],this.gameforeground4.y+=.08*this.movepath[e]},updateBrain:function(){this.brain.rotate()},getAvailableCapsule:function(){for(var e=0;e<Game.capsules.length;e++){var t=Game.capsules[e];if(0==t.getState())return t}},getAvailableRoadsideObj:function(e){for(var t=0;t<Game.roadsideobj.length;t++){var a=Game.roadsideobj[t];if(0==a.getState()&&a.getType()==e)return a}},getAvailableGift:function(e){for(var t=0;t<Game.gifts.length;t++){var a=Game.gifts[t];if(0==a.getState())return this.setGiftType(a,e),a}},setGiftType:function(e,t){function a(e,t){e.setSize({w:t.width,h:t.height}),e.setSize({w:t.width/2,h:t.height/2}),e._sprite.setTexture(t)}"gift"==t&&"gift"!=e._type?a(e,PIXI.loader.resources.roadfacestuff.textures["gift.png"]):"star"==t?a(e,PIXI.loader.resources.roadfacestuff.textures["star.png"]):"door"==t&&a(e,PIXI.loader.resources.roadfacestuff.textures["door.png"]),e.setType(t)},getAvailableMonster:function(){},recycleCapsule:function(){for(var e=0;e<Game.capsules.length;e++){var t=Game.capsules[e];1==t.getState()&&t.getPos().x<=-t.getSize().w&&(t.setState(0),Game.map.putObjToMap())}},recycleGift:function(){for(var e=0;e<Game.gifts.length;e++){var t=Game.gifts[e];1==t.getState()&&t.getPos().x<=-t.getSize().w&&(t.setState(0),Game.map.putObjToMap())}},recycleRoadsideObj:function(){for(var e=0;e<Game.roadsideobj.length;e++){var t=Game.roadsideobj[e];1==t.getState()&&t.getPos().x<=-t.getSize().w&&t.putInRoadSide()}},recycleMonster:function(){},putObjToMap:function(){if(6==Game.mapLevel)return!1;var e=Game.mapmodel["level"+Game.mapLevel];this.TotalStuffNum=e.length;var t=e[this.currentStuffNum].t,a=null;a="1"==t?this.getAvailableCapsule():this.getAvailableGift(t);var o=e[this.currentStuffNum].x,r=.74*Game.winH-a.getSize().h,n=e[this.currentStuffNum].y;n&&(r-=n),pos={x:o,y:r},Game.map.coutStuffloc+=Number(pos.x),pos.x=Game.map.coutStuffloc-Game.rundistance,a.updateState(1,pos),this.currentStuffNum+=1,this.currentStuffNum==this.TotalStuffNum&&(Game.mapLevel+=1,this.currentStuffNum=0)}};var GameMenuObj=function(){this.init()};GameMenuObj.prototype={init:function(){this.head=$(".progresswrap .head"),this.progress=$(".progresswrap .progress")[0],this.prizenum=$(".prizewrap .num").eq(0),"boy"==Game.gamerole?this.head.addClass("boyhead"):void 0,"girl"==Game.gamerole?this.head.addClass("girlhead"):void 0},onEnter:function(){},initScore:function(){},setScore:function(e){this.progress.style.width=e+"%"},getScore:function(){},initGiftScore:function(){},setGiftNum:function(e){this.prizenum.attr("data",e)},reset:function(){this.setScore(0),this.setGiftNum(0)},update:function(){Game.progress=Game.rundistance/Game.totaldistance*100,this.setScore(Game.progress),this.setGiftNum(Game.prize.length),Game.progress>100&&(Game.progress=100,Game.gameover())}};var GameHeroObj=function(){function e(){var e=Math.abs(Game.jumpH)/Game.hero.height;if(.2>e)a.state.setAnimationByName(0,"1jitiao_sender_0",!1),a.state.addAnimationByName(0,"cazryrun_sender_0",!0,0),Game.jump2=!1;else if(0==Game.jump2){Game.jump2=!0,a.state.setAnimationByName(0,"2jitiao_sender_0",!1),a.state.addAnimationByName(0,"cazryrun_sender_0",!0,0);try{Game.music.bgmusic.pause(),Game.music.jump2.play()}catch(t){}}}function t(){Game.jump1||Game.jump2?Game.jump2||(Game.jump1&&Game.jump1.pause(),Game.jump1=!1,Game.jump2=Game.cr.slide(a,a.position.x,a.position.y-.8*a.width,13/Game.lowphoneheroSpeed,"smoothstep"),Game.jump2.onComplete=function(){Game.jump2=Game.cr.slide(a,a.position.x,.73*Game.winH-a.height,13/Game.lowphoneheroSpeed,"smoothstepSquared"),Game.jump2.onComplete=function(){Game.jump2=!1}}):(Game.jump1=Game.cr.slide(a,a.position.x,a.position.y-.7*a.width,15/Game.lowphoneheroSpeed,"smoothstep"),Game.jump1.onComplete=function(){Game.jump1=Game.cr.slide(a,a.position.x,.73*Game.winH-a.height,15/Game.lowphoneheroSpeed,"smoothstepSquared"),Game.jump1.onComplete=function(){Game.jump1=!1}})}var a;if(Game.islowphone){var o=PIXI.loader.resources.heroframe.textures;this.heroframes=[o["heroframe1.png"],o["heroframe2.png"],o["heroframe3.png"],o["heroframe4.png"],o["heroframe5.png"],o["heroframe6.png"],o["heroframe7.png"],o["heroframe8.png"],o["heroframe9.png"],o["heroframe10.png"]],a=new PIXI.Sprite(this.heroframes[0]),a.height=a.height/1.4*Game.scale,a.width=a.width/1.4*Game.scale,a.position.x=.2*Game.winW,a.position.y=.73*Game.winH-a.height,this._sprite=a,$(Game.herodirector._renderer.view).bind("touchstart",t)}else a=new PIXI.spine.Spine(PIXI.loader.resources.herobone.spineData),a.skeleton.flipX=!0,a.width=a.width/3*Game.scale,a.height=a.height/3*Game.scale,a.position.x=.2*Game.winW,a.position.y=.73*Game.winH,a.skeleton.setSkinByName("default"),a.stateData.setMixByName("cazryrun_sender_0","cazryrun_sender_0",.2),a.stateData.setMixByName("1jitiao_sender_0","1jitiao_sender_0",.4),a.stateData.setMixByName("2jitiao_sender_0","2jitiao_sender_0",.4),a.state.setAnimationByName(0,"cazryrun_sender_0",!0),Game.jumpStoneIndex="boy"==Game.gamerole?18:22,$(Game.herodirector._renderer.view).bind("touchstart",e),this._sprite=a,this.height=a.height,this.width=a.width,Game.heroh=this.height,Game.herow=this.width,Game.jumpOriginH=this._sprite.children[Game.jumpStoneIndex].transform.localTransform.ty};GameHeroObj.prototype=new GameSpriteObj,GameHeroObj.prototype.reset=function(){Game.hero._sprite.tint=16777215,Game.islowphone||Game.hero._sprite.state.addAnimationByName(4,"cazryrun_sender_0",!1,0)},GameHeroObj.prototype.update=function(){if(Game.islowphone){var e=(.05*Game.rundistance).toFixed(0)%this.heroframes.length;this._sprite.texture=this.heroframes[e]}if(!Game.islowphone){var t=this._sprite.children[Game.jumpStoneIndex].transform.localTransform.ty;Game.jumpH=(t-Game.jumpOriginH)/3*Game.scale}},GameHeroObj.prototype.getRect=function(){return Game.islowphone?{x:this._sprite.x+.4*this._sprite.width,y:this._sprite.y,w:Math.floor(.3*this._sprite.width),h:Math.floor(this._sprite.height)}:{x:this._sprite.x-.1*this._sprite.width,y:this._sprite.y-this._sprite.height,w:Math.floor(.2*this._sprite.width),h:Math.floor(this._sprite.height)+Game.jumpH}};var GameCapsuleObj=function(){texture=PIXI.loader.resources.roadfacestuff.textures["capsule"+Math.ceil(2*Math.random())+".png"],this.init(texture.width/2*Game.scale,texture.height/2*Game.scale,texture),this.setState(0)};GameCapsuleObj.prototype=new GameSpriteObj,GameCapsuleObj.prototype.updateState=function(e,t){var t=t?t:{x:0,y:0};this.setState(e),0==this.getState()?this.setAlpha(0):1==this.getState()&&this.setAlpha(1),this.setPos(t)};var GameGiftObj=function(){this._type="gift";var e=PIXI.loader.resources.roadfacestuff.textures["gift.png"];this.init(e.width/2*Game.scale,e.height/2*Game.scale,e),this.setState(0)};GameGiftObj.prototype=new GameSpriteObj,GameGiftObj.prototype.updateState=function(e,t){var t=t?t:{x:0,y:0};this.setState(e),0==this.getState()?this.setAlpha(0):1==this.getState()&&this.setAlpha(1),this.setPos(t)},GameGiftObj.prototype.collisionEffect=function(){Game.giftEffectContainer.x=this._sprite.x,Game.giftEffectContainer.y=this._sprite.y,Game.particleStream.play(),setTimeout(function(){Game.particleStream.stop()},100)};var BrainObj=function(){texture=PIXI.loader.resources.brain.texture,this.init(texture.width/2*Game.scale,texture.height/2*Game.scale,texture),this._sprite.x=Game.winW-.1*this._sprite.height,this._sprite.y=.1*this._sprite.height};BrainObj.prototype=new GameSpriteObj,BrainObj.prototype.rotate=function(){this._sprite.rotation=.1*Game.rundistance*(Math.PI/180)};var RoadsideObj=function(){this.getRondomTexture=function(){var e=100*Math.random();return 20>e?PIXI.loader.resources.stuff.textures["roadside_obj3.png"]:60>e?PIXI.loader.resources.stuff.textures["roadside_obj1.png"]:70>e?PIXI.loader.resources.stuff.textures["roadside_obj2.png"]:80>e?PIXI.loader.resources.stuff.textures["roadside_obj4.png"]:90>e?PIXI.loader.resources.stuff.textures["roadside_obj5.png"]:PIXI.loader.resources.stuff.textures["roadside_obj0.png"]};var e=PIXI.loader.resources.stuff.textures["roadside_obj0.png"];null!=e&&this.init(e.width/2*Game.scale,e.height/2*Game.scale,e)};RoadsideObj.prototype=new GameSpriteObj,RoadsideObj.prototype.updateState=function(e,t){var t=t?t:{x:0,y:0};this.setState(e),this.setPos(t)},RoadsideObj.prototype.putInRoadSide=function(){var e=this.getRondomTexture();this._sprite._texture=e,this._sprite.width=e.width/2*Game.scale,this._sprite.height=e.height/2*Game.scale,pos={x:this.getSize().w,y:.73*Game.winH-this.getSize().h},Game.map.coutRSOloc+=pos.x+600*Math.random(),pos.x+=Game.map.coutRSOloc-Game.rundistance-this._sprite.width,this.updateState(1,pos)};